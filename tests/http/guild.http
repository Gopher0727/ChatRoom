@baseUrl = http://127.0.0.1:9000/api/v1
@user1_name = user_owner
@user1_email = owner@example.com
@user1_pass = password123

@user2_name = user_member
@user2_email = member@example.com
@user2_pass = password123

### 1. 注册用户1 (Owner)
POST {{baseUrl}}/users/register HTTP/1.1
Content-Type: application/json

{
    "username": "{{user1_name}}",
    "email": "{{user1_email}}",
    "password": "{{user1_pass}}"
}

### 2. 用户1 登录
# @name login1
POST {{baseUrl}}/users/login HTTP/1.1
Content-Type: application/json

{
    "username": "{{user1_name}}",
    "password": "{{user1_pass}}"
}

@token1 = {{login1.response.body.token}}

### 3. 用户1 创建 Guild
# @name createGuild
POST {{baseUrl}}/guilds HTTP/1.1
Authorization: Bearer {{token1}}
Content-Type: application/json

{
    "topic": "Golang 交流群"
}

@guild_id = {{createGuild.response.body.id}}

### 4. 用户1 生成邀请码
# @name createInvite
POST {{baseUrl}}/guilds/{{guild_id}}/invites HTTP/1.1
Authorization: Bearer {{token1}}
Content-Type: application/json

{}

@invite_code = {{createInvite.response.body.code}}

### 5. 注册用户2 (Member)
POST {{baseUrl}}/users/register HTTP/1.1
Content-Type: application/json

{
    "username": "{{user2_name}}",
    "email": "{{user2_email}}",
    "password": "{{user2_pass}}"
}

### 6. 用户2 登录
# @name login2
POST {{baseUrl}}/users/login HTTP/1.1
Content-Type: application/json

{
    "username": "{{user2_name}}",
    "password": "{{user2_pass}}"
}

@token2 = {{login2.response.body.token}}

### 7. 用户2 加入 Guild
POST {{baseUrl}}/guilds/join HTTP/1.1
Authorization: Bearer {{token2}}
Content-Type: application/json

{
    "invite_code": "{{invite_code}}"
}

### 8. 用户2 发送消息
POST {{baseUrl}}/guilds/{{guild_id}}/messages HTTP/1.1
Authorization: Bearer {{token2}}
Content-Type: application/json

{
    "content": "大家好，我是新来的！",
    "msg_type": "text"
}

### 9. 用户1 获取消息列表
GET {{baseUrl}}/guilds/{{guild_id}}/messages?limit=10&offset=0 HTTP/1.1
Authorization: Bearer {{token1}}
Content-Type: application/json
